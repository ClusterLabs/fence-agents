<?xml version="1.0" ?>
<resource-agent name="fence_vmware" shortdesc="Fence agent for VMWare" >
<longdesc>fence_vmware is an I/O Fencing agent which can be used with the VMware ESX, VMware ESXi or VMware Server to fence virtual machines.

Before you can use this agent, it must be installed VI Perl Toolkit or vmrun command on every node you want to make fencing.

VI Perl Toolkit is preferred for VMware ESX/ESXi and Virtual Center. Vmrun command is only solution for VMware Server 1/2 (this command will works against ESX/ESXi 3.5 up2 and VC up2 too, but not cluster aware!) and is available as part of VMware VIX API SDK package. VI Perl and VIX API SDK are both available from VMware web pages (not int RHEL repository!). 

You can specify type of VMware you are connecting to with -d switch (or vmware_type for stdin). Possible values are esx, server2 and server1.Default value is esx, which will use VI Perl. With server1 and server2, vmrun command is used.

After you have successfully installed VI Perl Toolkit or VIX API, you should be able to run fence_vmware_helper (part of this agent) or vmrun command. This agent supports only vmrun from version 2.0.0 (VIX API 1.6.0).</longdesc>
<vendor-url>http://www.vmware.com</vendor-url>
<parameters>
	<parameter name="action" unique="0" required="1">
		<getopt mixed="-o, --action=[action]" />
		<content type="string" default="reboot"  />
		<shortdesc lang="en">Fencing action</shortdesc>
	</parameter>
	<parameter name="exec" unique="0" required="0">
		<getopt mixed="-e, --exec=[command]" />
		<content type="string"  />
		<shortdesc lang="en">Command to execute</shortdesc>
	</parameter>
	<parameter name="identity_file" unique="0" required="0">
		<getopt mixed="-k, --identity-file=[filename]" />
		<content type="string"  />
		<shortdesc lang="en">Identity file (private key) for SSH</shortdesc>
	</parameter>
	<parameter name="inet4_only" unique="0" required="0">
		<getopt mixed="-4, --inet4-only" />
		<content type="boolean"  />
		<shortdesc lang="en">Forces agent to use IPv4 addresses only</shortdesc>
	</parameter>
	<parameter name="inet6_only" unique="0" required="0">
		<getopt mixed="-6, --inet6-only" />
		<content type="boolean"  />
		<shortdesc lang="en">Forces agent to use IPv6 addresses only</shortdesc>
	</parameter>
	<parameter name="ip" unique="0" required="0" obsoletes="ipaddr">
		<getopt mixed="-a, --ip=[ip]" />
		<content type="string"  />
		<shortdesc lang="en">IP address or hostname of fencing device</shortdesc>
	</parameter>
	<parameter name="ipaddr" unique="0" required="0" deprecated="1">
		<getopt mixed="-a, --ip=[ip]" />
		<content type="string"  />
		<shortdesc lang="en">IP address or hostname of fencing device</shortdesc>
	</parameter>
	<parameter name="ipport" unique="0" required="0">
		<getopt mixed="-u, --ipport=[port]" />
		<content type="integer" default="22"  />
		<shortdesc lang="en">TCP/UDP port to use for connection with device</shortdesc>
	</parameter>
	<parameter name="login" unique="0" required="1" deprecated="1">
		<getopt mixed="-l, --username=[name]" />
		<content type="string"  />
		<shortdesc lang="en">Login name</shortdesc>
	</parameter>
	<parameter name="passwd" unique="0" required="0" deprecated="1">
		<getopt mixed="-p, --password=[password]" />
		<content type="string"  />
		<shortdesc lang="en">Login password or passphrase</shortdesc>
	</parameter>
	<parameter name="passwd_script" unique="0" required="0" deprecated="1">
		<getopt mixed="-S, --password-script=[script]" />
		<content type="string"  />
		<shortdesc lang="en">Script to run to retrieve password</shortdesc>
	</parameter>
	<parameter name="password" unique="0" required="0" obsoletes="passwd">
		<getopt mixed="-p, --password=[password]" />
		<content type="string"  />
		<shortdesc lang="en">Login password or passphrase</shortdesc>
	</parameter>
	<parameter name="password_script" unique="0" required="0" obsoletes="passwd_script">
		<getopt mixed="-S, --password-script=[script]" />
		<content type="string"  />
		<shortdesc lang="en">Script to run to retrieve password</shortdesc>
	</parameter>
	<parameter name="plug" unique="0" required="0" obsoletes="port">
		<getopt mixed="-n, --plug=[ip]" />
		<content type="string"  />
		<shortdesc lang="en">IP address or hostname of fencing device (together with --port-as-ip)</shortdesc>
	</parameter>
	<parameter name="port" unique="0" required="0" deprecated="1">
		<getopt mixed="-n, --plug=[ip]" />
		<content type="string"  />
		<shortdesc lang="en">IP address or hostname of fencing device (together with --port-as-ip)</shortdesc>
	</parameter>
	<parameter name="secure" unique="0" required="0" deprecated="1">
		<getopt mixed="-x, --ssh" />
		<content type="boolean" default="1"  />
		<shortdesc lang="en">Use SSH connection</shortdesc>
	</parameter>
	<parameter name="ssh" unique="0" required="0" obsoletes="secure">
		<getopt mixed="-x, --ssh" />
		<content type="boolean" default="1"  />
		<shortdesc lang="en">Use SSH connection</shortdesc>
	</parameter>
	<parameter name="ssh_options" unique="0" required="0">
		<getopt mixed="--ssh-options=[options]" />
		<content type="string"  />
		<shortdesc lang="en">SSH options to use</shortdesc>
	</parameter>
	<parameter name="username" unique="0" required="1" obsoletes="login">
		<getopt mixed="-l, --username=[name]" />
		<content type="string"  />
		<shortdesc lang="en">Login name</shortdesc>
	</parameter>
	<parameter name="vmware_type" unique="0" required="0">
		<getopt mixed="-d, --vmware_type=[type]" />
		<content type="string" default="esx"  />
		<shortdesc lang="en">Type of VMware to connect</shortdesc>
	</parameter>
	<parameter name="vmware_datacenter" unique="0" required="0">
		<getopt mixed="-s, --vmware-datacenter=[dc]" />
		<content type="string"  />
		<shortdesc lang="en">VMWare datacenter filter</shortdesc>
	</parameter>
	<parameter name="quiet" unique="0" required="0">
		<getopt mixed="-q, --quiet" />
		<content type="boolean"  />
		<shortdesc lang="en">Disable logging to stderr. Does not affect --verbose or --debug-file or logging to syslog.</shortdesc>
	</parameter>
	<parameter name="verbose" unique="0" required="0">
		<getopt mixed="-v, --verbose" />
		<content type="boolean"  />
		<shortdesc lang="en">Verbose mode. Multiple -v flags can be stacked on the command line (e.g., -vvv) to increase verbosity.</shortdesc>
	</parameter>
	<parameter name="verbose_level" unique="0" required="0">
		<getopt mixed="--verbose-level" />
		<content type="integer"  />
		<shortdesc lang="en">Level of debugging detail in output. Defaults to the number of --verbose flags specified on the command line, or to 1 if verbose=1 in a stonith device configuration (i.e., on stdin).</shortdesc>
	</parameter>
	<parameter name="debug" unique="0" required="0" deprecated="1">
		<getopt mixed="-D, --debug-file=[debugfile]" />
		<content type="string"  />
		<shortdesc lang="en">Write debug information to given file</shortdesc>
	</parameter>
	<parameter name="debug_file" unique="0" required="0" obsoletes="debug">
		<getopt mixed="-D, --debug-file=[debugfile]" />
		<content type="string"  />
		<shortdesc lang="en">Write debug information to given file</shortdesc>
	</parameter>
	<parameter name="version" unique="0" required="0">
		<getopt mixed="-V, --version" />
		<content type="boolean"  />
		<shortdesc lang="en">Display version information and exit</shortdesc>
	</parameter>
	<parameter name="help" unique="0" required="0">
		<getopt mixed="-h, --help" />
		<content type="boolean"  />
		<shortdesc lang="en">Display help and exit</shortdesc>
	</parameter>
	<parameter name="delay" unique="0" required="0">
		<getopt mixed="--delay=[seconds]" />
		<content type="second" default="0"  />
		<shortdesc lang="en">Wait X seconds before fencing is started</shortdesc>
	</parameter>
	<parameter name="disable_timeout" unique="0" required="0">
		<getopt mixed="--disable-timeout=[true/false]" />
		<content type="string"  />
		<shortdesc lang="en">Disable timeout (true/false) (default: true when run from Pacemaker 2.0+)</shortdesc>
	</parameter>
	<parameter name="login_timeout" unique="0" required="0">
		<getopt mixed="--login-timeout=[seconds]" />
		<content type="second" default="5"  />
		<shortdesc lang="en">Wait X seconds for cmd prompt after login</shortdesc>
	</parameter>
	<parameter name="port_as_ip" unique="0" required="0">
		<getopt mixed="--port-as-ip" />
		<content type="boolean"  />
		<shortdesc lang="en">Make "port/plug" to be an alias to IP address</shortdesc>
	</parameter>
	<parameter name="power_timeout" unique="0" required="0">
		<getopt mixed="--power-timeout=[seconds]" />
		<content type="second" default="20"  />
		<shortdesc lang="en">Test X seconds for status change after ON/OFF</shortdesc>
	</parameter>
	<parameter name="power_wait" unique="0" required="0">
		<getopt mixed="--power-wait=[seconds]" />
		<content type="second" default="0"  />
		<shortdesc lang="en">Wait X seconds after issuing ON/OFF</shortdesc>
	</parameter>
	<parameter name="shell_timeout" unique="0" required="0">
		<getopt mixed="--shell-timeout=[seconds]" />
		<content type="second" default="3"  />
		<shortdesc lang="en">Wait X seconds for cmd prompt after issuing command</shortdesc>
	</parameter>
	<parameter name="stonith_status_sleep" unique="0" required="0">
		<getopt mixed="--stonith-status-sleep=[seconds]" />
		<content type="second" default="1"  />
		<shortdesc lang="en">Sleep X seconds between status calls during a STONITH action</shortdesc>
	</parameter>
	<parameter name="retry_on" unique="0" required="0">
		<getopt mixed="--retry-on=[attempts]" />
		<content type="integer" default="1"  />
		<shortdesc lang="en">Count of attempts to retry power on</shortdesc>
	</parameter>
	<parameter name="ssh_path" unique="0" required="0">
		<getopt mixed="--ssh-path=[path]" />
		<shortdesc lang="en">Path to ssh binary</shortdesc>
	</parameter>
</parameters>
<actions>
	<action name="on" automatic="0"/>
	<action name="off" />
	<action name="reboot" />
	<action name="status" />
	<action name="monitor" />
	<action name="metadata" />
	<action name="manpage" />
	<action name="validate-all" />
</actions>
</resource-agent>
